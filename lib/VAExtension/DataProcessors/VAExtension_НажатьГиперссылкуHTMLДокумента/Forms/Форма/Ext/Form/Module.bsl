#Область ОбработчикиКомандФормы

&НаКлиенте
Процедура ВыполнитьКодКлиент(Команда)
	СсылкаНайдена = Ложь;
	
	Окна = ПолучитьОкна();
	Результат = Новый Массив;
	
	ОкноНайдено = Ложь;
	ОкноНачальнойСтраницы = Неопределено;
	
	Для Каждого ТекОкно Из Окна Цикл
		
		Если ТекОкно.Заголовок = ЗначениеЗаголовокОкна Тогда
			Если ТекОкно.Содержимое.Количество() > 0 Тогда
				ПолеHTMLДокумента = ТекОкно.Содержимое[0].Элементы[ЗначениеИмяЭлементаФормы];
				НажатьНаГиперссылку(ПолеHTMLДокумента);
				ОкноНайдено = Истина;
				Прервать;
			КонецЕсли;	 
		КонецЕсли;
		
		Если ЗначениеЗаголовокОкна = "Начальная страница" И ТекОкно.НачальнаяСтраница И ТекОкно.Заголовок = "" Тогда
			// Иногда начальная страница не содержит заголовка, но отображается она с заголовком "Начальная страница"
			// Тоесть ванесса ищет окно с заголовком "Начальная страница", но такого окна в списке "ПолучитьОкна()" нет
			// проверим на эти условия и запомним окно
			ОкноНачальнойСтраницы = ТекОкно;
		КонецЕсли;
		
	КонецЦикла;
	
	Если НЕ ОкноНайдено И ОкноНачальнойСтраницы <> Неопределено Тогда
		Если ОкноНачальнойСтраницы.Содержимое.Количество() > 0 Тогда
			// Мы не нашли окно, но зато нашли окно начальной страницы без заголовка
			ПолеHTMLДокумента = ОкноНачальнойСтраницы.Содержимое[0].Элементы[ЗначениеИмяЭлементаФормы];
			НажатьНаГиперссылку(ПолеHTMLДокумента);
		КонецЕсли;
	КонецЕсли;
	
	ВыражениеВычислено = Истина;
	
КонецПроцедуры

&НаКлиенте
Процедура ЗакрытьФорму(Команда)
	Закрыть();
КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

&НаКлиенте
Процедура НажатьНаГиперссылку(ПолеHTMLДокумента)
	
	Если ТипГиперссылки = 0 Тогда
		//Нажатие гиперссылки по номеру
		ПолеHTMLДокумента.Документ.links[Число(ИмяГиперссылки)].click();
		СсылкаНайдена = Истина;
	Иначе
		//Если ТипГиперссылки = 1  Тогда
		//Нажатие гиперссылки по представлению
		Для Сч = 1 По ПолеHTMLДокумента.Документ.links.length Цикл
			ТекСсылка = ПолеHTMLДокумента.Документ.links[Сч - 1];
			Если ТипГиперссылки = 1 Тогда
				Если Найти(НРег(ТекСсылка.text), НРег(ИмяГиперссылки)) > 0 Тогда
					ТекСсылка.click();
					СсылкаНайдена = Истина;
					Прервать;
				КонецЕсли;
			Иначе	
				Если Найти(НРег(ТекСсылка.href), НРег(ИмяГиперссылки)) > 0 Тогда
					ТекСсылка.click();
					СсылкаНайдена = Истина;
					Прервать;
				КонецЕсли;
			КонецЕсли;	 
		КонецЦикла;	
	КонецЕсли;	 
КонецПроцедуры 

#КонецОбласти