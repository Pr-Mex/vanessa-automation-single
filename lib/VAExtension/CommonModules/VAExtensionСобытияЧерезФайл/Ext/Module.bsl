

#Область ПрограммныйИнтерфейс

////////////////////////////////////////////////////////////////////////////////
//
// Процедура 
//
// Описание:
//
//
// Параметры (название, тип, дифференцированное значение)
// КаталогМониторинга - Строка - Каталог который надо мониторить для выпонения события из файла
//
Процедура ВключитьМониторингКаталога(Каталог) Экспорт
	
	Если VAExtension_КаталогиМониторинга = Неопределено Тогда
		VAExtension_КаталогиМониторинга = Новый Массив;
	КонецЕсли;	
	
	ПоискЗаписи = VAExtension_КаталогиМониторинга.Найти(Каталог);
	Если ПоискЗаписи = Неопределено Тогда
		VAExtension_КаталогиМониторинга.Добавить(Каталог);
		Если VAExtension_КаталогиМониторинга.Количество() = 1 Тогда
			// Включаем обработчик на первом элементе массива
			ПодключитьОбработчикОжидания("VAExtension_ПроверкаКаталогаНаНовыеСобытия", 1, Ложь);
		КонецЕсли;	
	КонецЕсли;	
	
КонецПроцедуры // ВключитьМониторингКаталога

////////////////////////////////////////////////////////////////////////////////
//
// Процедура 
//
// Описание:
//
//
// Параметры (название, тип, дифференцированное значение)
// КаталогМониторинга - Строка - Каталог который надо мониторить для выпонения события из файла
//
Процедура ВыключитьМониторингКаталога(Каталог) Экспорт
	
	Если VAExtension_КаталогиМониторинга = Неопределено Тогда
		// Массив каталогов уже не существует - отключаем обработчик
		ОтключитьОбработчикОжидания("VAExtension_ПроверкаКаталогаНаНовыеСобытия");
		Возврат;
	КонецЕсли;	
	
	
	Если Не ЗначениеЗаполнено(Каталог) Тогда
		// Команда полного отключения мониторинга
		ОтключитьОбработчикОжидания("VAExtension_ПроверкаКаталогаНаНовыеСобытия");
		VAExtension_КаталогиМониторинга = Неопределено;
		Возврат;
	КонецЕсли;	
	
	
	Если VAExtension_КаталогиМониторинга.Количество() > 1 Тогда
		// Записей несколько, каталог задан - ищем запись
		ПоискЗаписи = VAExtension_КаталогиМониторинга.Найти(Каталог);
		Если ПоискЗаписи <> Неопределено Тогда
			// Запись нашли - удалим из массива запись о требуемом каталоге
			VAExtension_КаталогиМониторинга.Удалить(ПоискЗаписи);
			Возврат;
		Иначе	
			// Запись не нашли - это ошибка
			ВызватьИсключение "Каталог задан не верно"; 
		КонецЕсли;	
	Иначе
		// запись последняя или массив пустой
		ОтключитьОбработчикОжидания("VAExtension_ПроверкаКаталогаНаНовыеСобытия");	
		VAExtension_КаталогиМониторинга = Неопределено;
	КонецЕсли;	
	
КонецПроцедуры // ВыключитьМониторингКаталога


#КонецОбласти

#Область СлужебныеПроцедурыИФункции

#КонецОбласти
