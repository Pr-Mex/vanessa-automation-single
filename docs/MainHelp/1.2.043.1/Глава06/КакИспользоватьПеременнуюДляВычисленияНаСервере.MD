##### [Ссылка на видео](https://vkvideo.ru/video-235354700_456239325)

001. Привет! В этом уроке я расскажу тебе про то, как использовать переменную для вычисления выражения на сервере. Давай откроем второй экземпляр Ванессы в режиме обучения.

![](https://vanessa-files.do.bit-erp.ru/Doc/1.2.043.1/MD/Глава06/images/00000_63902994974791_КакИспользоватьПеременнуюДляВычисленияНаСервере.png)

002. Загрузим тестовый пример.

![](https://vanessa-files.do.bit-erp.ru/Doc/1.2.043.1/MD/Глава06/images/00004_63902994986880_КакИспользоватьПеременнуюДляВычисленияНаСервере.png)

003. Существует два основных способа для передачи переменной в выражение на сервере.

![](https://vanessa-files.do.bit-erp.ru/Doc/1.2.043.1/MD/Глава06/images/00005_63902994987798_КакИспользоватьПеременнуюДляВычисленияНаСервере.png)

004. Первый способ - это использовать специальные шаги, которые умеют вычислять выражение на сервере и передавать на сервер значения переменных

![](https://vanessa-files.do.bit-erp.ru/Doc/1.2.043.1/MD/Глава06/images/00008_63902994989270_КакИспользоватьПеременнуюДляВычисленияНаСервере.png)

005. Есть и другие способоы, которые использовались в предыдущих версиях Vanessa Automation.

![](https://vanessa-files.do.bit-erp.ru/Doc/1.2.043.1/MD/Глава06/images/00011_63902994993375_КакИспользоватьПеременнуюДляВычисленияНаСервере.png)

006. В данном примере первый шаг - это чтение содержимого файла в переменную.

![](https://vanessa-files.do.bit-erp.ru/Doc/1.2.043.1/MD/Глава06/images/00014_63902994994900_КакИспользоватьПеременнуюДляВычисленияНаСервере.png)

007. Затем происходит удвоение кавычек.

![](https://vanessa-files.do.bit-erp.ru/Doc/1.2.043.1/MD/Глава06/images/00019_63902995000343_КакИспользоватьПеременнуюДляВычисленияНаСервере.png)

008. Затем происходит добавление к символу переноса строки вертикальной черты.

![](https://vanessa-files.do.bit-erp.ru/Doc/1.2.043.1/MD/Глава06/images/00024_63902995005889_КакИспользоватьПеременнуюДляВычисленияНаСервере.png)

009. После этого строка, которая содержится в переменной может использоваться в вычислении выражения на сервере.

![](https://vanessa-files.do.bit-erp.ru/Doc/1.2.043.1/MD/Глава06/images/00029_63902995011358_КакИспользоватьПеременнуюДляВычисленияНаСервере.png)

010. Есть второй вариант. Он более простой.

![](https://vanessa-files.do.bit-erp.ru/Doc/1.2.043.1/MD/Глава06/images/00032_63902995015506_КакИспользоватьПеременнуюДляВычисленияНаСервере.png)

011. Сначала также происходит чтение файла в переменную.

![](https://vanessa-files.do.bit-erp.ru/Doc/1.2.043.1/MD/Глава06/images/00035_63902995017142_КакИспользоватьПеременнуюДляВычисленияНаСервере.png)

012. Затем с помощью выражения встроенного языка значение переменной помещается в специальный реквизит.

![](https://vanessa-files.do.bit-erp.ru/Doc/1.2.043.1/MD/Глава06/images/00040_63902995022575_КакИспользоватьПеременнуюДляВычисленияНаСервере.png)

013. Затем значение из реквизита используется в выражении на сервере

![](https://vanessa-files.do.bit-erp.ru/Doc/1.2.043.1/MD/Глава06/images/00045_63902995028016_КакИспользоватьПеременнуюДляВычисленияНаСервере.png)

014. Далее можно через тот же реквизит вернуть значение, вычисленное на сервере, в переменную.

![](https://vanessa-files.do.bit-erp.ru/Doc/1.2.043.1/MD/Глава06/images/00050_63902995033570_КакИспользоватьПеременнуюДляВычисленияНаСервере.png)

015. И важно помнить, что гораздо лучше не использовать в сценариях код на встроенном языке, а лучше создать новый шаг или шаги, которые будут выполнять те же действия.

![](https://vanessa-files.do.bit-erp.ru/Doc/1.2.043.1/MD/Глава06/images/00053_63902995036834_КакИспользоватьПеременнуюДляВычисленияНаСервере.png)

016. На этом всё, переходи к следующему уроку интерактивной справки.

![](https://vanessa-files.do.bit-erp.ru/Doc/1.2.043.1/MD/Глава06/images/00054_63902995037158_КакИспользоватьПеременнуюДляВычисленияНаСервере.png)
