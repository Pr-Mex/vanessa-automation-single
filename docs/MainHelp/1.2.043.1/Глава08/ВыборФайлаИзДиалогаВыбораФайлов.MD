##### [Ссылка на видео](https://vkvideo.ru/video-235354700_456239343)

001. Привет! В этом уроке я расскажу тебе про то, как выполнить выбор файла из диалога выбора файлов. Давай откроем второй экземпляр Ванессы в режиме обучения.

![](https://vanessa-files.do.bit-erp.ru/Doc/1.2.043.1/MD/Глава08/images/00000_63902995716877_ВыборФайлаИзДиалогаВыбораФайлов.png)

002. Сначала мы поговорим как выполнить выбор файла в тонком клиенте.

![](https://vanessa-files.do.bit-erp.ru/Doc/1.2.043.1/MD/Глава08/images/00001_63902995723492_ВыборФайлаИзДиалогаВыбораФайлов.png)

003. Загрузим тестовый пример.

![](https://vanessa-files.do.bit-erp.ru/Doc/1.2.043.1/MD/Глава08/images/00006_63902995728667_ВыборФайлаИзДиалогаВыбораФайлов.png)

004. Для того, чтобы подменить результат выбора файла на нужный в тонком и толстом клиенте - надо использовать специальный шаг - и я выбираю файл.

![](https://vanessa-files.do.bit-erp.ru/Doc/1.2.043.1/MD/Глава08/images/00009_63902995730126_ВыборФайлаИзДиалогаВыбораФайлов.png)

005. Этот шаг используется как для выбора файлов для открытия их на чтение - так и для записи файлов.

![](https://vanessa-files.do.bit-erp.ru/Doc/1.2.043.1/MD/Глава08/images/00014_63902995735771_ВыборФайлаИзДиалогаВыбораФайлов.png)

006. У этого шага один параметр и в него надо передать полный путь к файлу.

![](https://vanessa-files.do.bit-erp.ru/Doc/1.2.043.1/MD/Глава08/images/00019_63902995741508_ВыборФайлаИзДиалогаВыбораФайлов.png)

007. Важный момент. Этот шаг надо вызвать до того как появился диалог выбора файлов.

![](https://vanessa-files.do.bit-erp.ru/Doc/1.2.043.1/MD/Глава08/images/00022_63902995745639_ВыборФайлаИзДиалогаВыбораФайлов.png)

008. То есть этот шаг надо вызвать до того действия, которое приводит к появлению диалога выбора файлов.

![](https://vanessa-files.do.bit-erp.ru/Doc/1.2.043.1/MD/Глава08/images/00025_63902995747160_ВыборФайлаИзДиалогаВыбораФайлов.png)

009. Если всё сделано правильно, то диалог выбора файлов не должен появиться на экране и сценарий будет выполняться дальше.

![](https://vanessa-files.do.bit-erp.ru/Doc/1.2.043.1/MD/Глава08/images/00028_63902995751289_ВыборФайлаИзДиалогаВыбораФайлов.png)

010. Теперь поговорим как выполнить выбор файла в web клиенте.

![](https://vanessa-files.do.bit-erp.ru/Doc/1.2.043.1/MD/Глава08/images/00029_63902995751511_ВыборФайлаИзДиалогаВыбораФайлов.png)

011. Загрузим тестовый пример.

![](https://vanessa-files.do.bit-erp.ru/Doc/1.2.043.1/MD/Глава08/images/00034_63902995755609_ВыборФайлаИзДиалогаВыбораФайлов.png)

012. В web клиенте нужно сначала выполнить шаг, который приводит к появлению диалога выбора файла.

![](https://vanessa-files.do.bit-erp.ru/Doc/1.2.043.1/MD/Глава08/images/00037_63902995757170_ВыборФайлаИзДиалогаВыбораФайлов.png)

013. При этом в браузере должен появиться этот диалог.

![](https://vanessa-files.do.bit-erp.ru/Doc/1.2.043.1/MD/Глава08/images/00040_63902995761197_ВыборФайлаИзДиалогаВыбораФайлов.png)

014. После этого надо вызвать другой специальный шаг - и я выбираю файл ВК

![](https://vanessa-files.do.bit-erp.ru/Doc/1.2.043.1/MD/Глава08/images/00043_63902995762835_ВыборФайлаИзДиалогаВыбораФайлов.png)

015. Этот шаг через эмуляцию нажатия клавиш выполняет выбор файла в браузере, поэтому браузер в этот момент должен быть активным окном.

![](https://vanessa-files.do.bit-erp.ru/Doc/1.2.043.1/MD/Глава08/images/00046_63902995766962_ВыборФайлаИзДиалогаВыбораФайлов.png)

016. Важный момент. Для работы этого шага надо включить использование внешней компоненты VanessaExt.

![](https://vanessa-files.do.bit-erp.ru/Doc/1.2.043.1/MD/Глава08/images/00047_63902995767186_ВыборФайлаИзДиалогаВыбораФайлов.png)

017. На этом всё, переходи к следующему уроку интерактивной справки.

![](https://vanessa-files.do.bit-erp.ru/Doc/1.2.043.1/MD/Глава08/images/00048_63902995767398_ВыборФайлаИзДиалогаВыбораФайлов.png)
